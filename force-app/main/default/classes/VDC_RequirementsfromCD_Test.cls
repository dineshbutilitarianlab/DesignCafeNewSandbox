@isTest
public class VDC_RequirementsfromCD_Test {
    
    @isTest
    static void RequirementsfromCDAPI(){     
        TriggerControl__c cuset1 = new TriggerControl__c();
        cuset1.Name = 'LeadTrigger';
        cuset1.Run__c = true;
        insert cuset1; 
        DCWebengage__c  cuset2= new DCWebengage__c();
        cuset2.Name = 'Dcwebengage';
        cuset2.BearerToken__c = '097a1996-03d2-4870-8bbc-339eb9e239b7';
        cuset2.url__c= 'https://api.webengage.com/v1/accounts/aa131ca9/users';
        insert cuset2; 
        SRR__c SRRmum = new SRR__c();
        SRRmum.Name = 'Mumbai';
        SRRmum.index__c = 0;
        insert SRRmum;
        SRR__c SRRWDC = new SRR__c();
        SRRWDC.Name = 'WDC';
        SRRWDC.index__c = 0;
        insert SRRWDC;
        SRR__c SRRHyd = new SRR__c();
        SRRHyd.Name = 'Hyderabad';
        SRRHyd.index__c = 0;
        insert SRRHyd;
        SRR__c SRRMGDC = new SRR__c();
        SRRMGDC.Name = 'MGDC';
        SRRMGDC.index__c = 0;
        insert SRRMGDC;
        SRR__c SRRHSR = new SRR__c();
        SRRHSR.Name = 'HSR';
        SRRHSR.index__c = 0;
        insert SRRHSR;
        SRR__c SRRCHE = new SRR__c();
        SRRCHE.Name = 'Chennai';
        SRRCHE.index__c = 0;
        insert SRRCHE;
        SRR__c SRRjpdc = new SRR__c();
        SRRjpdc.Name = 'JPDC';
        SRRjpdc.index__c = 0;
        insert SRRjpdc;
        SRR__c SRRthane = new SRR__c();
        SRRthane.Name = 'Thane DC';
        SRRthane.index__c = 0;
        insert SRRthane; 
        
        SRR__c SRRMysore = new SRR__c();
        SRRMysore.Name = 'KDRMYS';
        SRRMysore.index__c = 0;
        insert SRRMysore;    
        SRR__c SRRPune = new SRR__c();
        SRRPune.Name = 'YERPUN';
        SRRPune.index__c = 0;
		insert SRRPune;
        SRR__c SRRBHHyd = new SRR__c();
        SRRBHHyd.Name = 'BHHYD';
        SRRBHHyd.index__c = 0;
        insert SRRBHHyd;    
        SRR__c SRRSJP = new SRR__c();
        SRRSJP.Name = 'SJPBLR';
        SRRSJP.index__c = 0;
        insert SRRSJP; 
        
        SRR__c SRRKHM = new SRR__c();
        SRRKHM.Name ='KHMUM';
        SRRKHM.index__c = 0;
        insert SRRKHM;  
        Leadtogenesys__c lts = new Leadtogenesys__c();
        lts.Name = 'genesysapi';
        lts.url__c = 'LeadTrigger';
        insert lts;
        DC_Center_To_Group_Mapping__c Dcgm = new DC_Center_To_Group_Mapping__c();
        Dcgm.Name = 'testing';
        Dcgm.Venue_Name__c = 'MGDC';
        Dcgm.Public_Group_Name__c = 'Sales MGDC_1';
        insert Dcgm; 
        CPPortal__c  cuset3= new CPPortal__c();
        cuset3.Name = 'cpportalupdate';
        cuset3.url__c= 'https://uat-api.designcafe.com/pp/updateLead';
        insert cuset3; 
        CPPortal__c  cuset4= new CPPortal__c();
        cuset4.Name = 'cpportalinsert';
        cuset4.url__c= 'https://uat-api.designcafe.com/pp/insertLead';
        insert cuset4;
        String myJSON = '{ "mobile":"0000000000","property_type":"1 BHK;Villa","floor_area":"string","scope_of_work":"Home interiors;Renovation","site_services":true,"site_service_needed_for":"False Ceiling;Painting","interior_work_needed_for":"Modular Kitchen","interior_details":"TV Unit;Study Unit","property_usage":"Self;Rental","where_are_you_currently_located":"string","when_would_you_like_to_have_the_home":"2 to 3 Months","which_language_are_you_most_comfortable":"string","if_other_languages_please_specify":"string","who_will_be_staying_in_the_house":"Us;Parents;Kids","how_many_kids_do_you_have":"string","gender_of_first_kid":"string","gender_of_second_kid":"string","gender_of_third_kid":"string","gender_of_fourth_kid":"string","age_of_first_kid":"string","age_of_second_kid":"string","age_of_third_kid":"string","age_of_fourth_kid" :"string","do_you_have_pets":"string","live":"Cooking;","others_for_live":"string","work":"No","eat":"Self","play":"Workout","others_for_play":"string"}';
        RestRequest request = new RestRequest();
        request.requestUri ='https://uat-dcafe.cs72.force.com/customerdashboard/services/apexrest/requirementsapi';
        request.httpMethod = 'POST';
        request.addHeader('Content-Type', 'application/json');
        request.requestBody = Blob.valueof(myJSON); 
        RestContext.request = request;
        RestResponse RestResponse = New RestResponse();
        RestResponse.statusCode = 200;
        RestContext.response = RestResponse;
        Lead Leadins = new lead();
        Leadins.Approx_Budget__c = '2L to 3L';
        Leadins.Status ='prospect';
        Leadins.Call_Stage__c='Meeting Scheduled';
        Leadins.DC_Lead_Status__c ='Meeting Scheduled';
        Leadins.Meeting_Type__c = 'EC';
        Leadins.Meeting_Venue__c = 'Mumbai DC';
        Leadins.Willingness_For_Meeting__c = system.today();
        Leadins.Channel__c = 'Online';
        Leadins.Source__c = 'Direct';
        Leadins.City = 'Mumbai';
        Leadins.How_did_you_hear_about_us__c ='Online';
        Leadins.Campagin__c ='Direct';
        Leadins.Source_Journey__c='Online';
        Leadins.LastName = 'test';
        Leadins.MobilePhone = '+910000000000';
       // Leadins.CreatedDate = system.today().adddays(-10);
        Leadins.Civil_Work__c = true;
        insert Leadins;
        VDC_RequirementsfromCD.doPost();
        Test.setMock(HttpCalloutMock.class, new DC_Webengage_mockup());
    }
}